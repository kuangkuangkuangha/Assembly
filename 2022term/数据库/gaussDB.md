

![sql](/Users/zhangkuang/Documents/College/2022term/数据库/sql.png)

逻辑视角下，可以看到数据库节点上对象包含

- 表空间（table space）

- 数据库(database)

- 数据文件(data segment)

- 表(table)

- 数据块(data block)

![sql2](/Users/zhangkuang/Documents/College/2022term/数据库/sql2.png)



#### 表空间

**openGauss自带了两个表空间：pg_default和pg_global。**

● 默认表空间pg_default：用来存储非共享系统表、用户表、用户表index、临时

表、临时表index、内部临时表的默认表空间。对应存储目录为实例数据目录下的

base目录。

● 共享表空间pg_global：用来存放共享系统表的表空间。对应存储目录为实例数据

目录下的global目录。



#### 模式

schema又称作模式。通过管理schema，**允许多个用户使用同一数据库而不相互干****扰**，可以将数据库对象组织成易于管理的逻辑组，同时便于将第三方应用添加到相应的schema下而不引起冲突。 管理schema包括：创建schema、使用schema、删除schema、设置schema的搜索路径以及schema的权限控制。

```ABAP
相当于在同一个数据库下为各个用户分配不同的用户空间
```

- 在每次创建新用户时，系统会在当前登录的数据库中为新用户创建一个同名Schema。对于其他数据库，若需要同名Schema，则需要用户手动创建。

- **pg_temp**和**pg_catalog**始终会作为搜索路径顺序中的前两位，无论二者是否出现在search_path中，或者出现在search_path中的任何位置。



- postgres为openGauss安装完成后默认生成的数据库。初始可以连接到此数据库进行新数据库的创建。



数据库连接工具**gsql**



#### 数据库对象

数据库对象包括：

- 用户（对数据库有权限访问的人）、
- 视图（显示用户需要的数据项）、
- 索引（给用户提供快速访问数据的途径）、
- 触发器（用户定义的SQL事务命令集合）、
- 序列（提供了唯一数值的顺序表）、
- 图表（数据库表之间的一种关系示意图）。

![C79D790D-B96D-4161-8E24-EE1A413A905F](/Users/zhangkuang/Documents/College/2022term/数据库/C79D790D-B96D-4161-8E24-EE1A413A905F.png)



#### 常用指令

gsql工具提供了若干高级特性，便于用户使用。常见用法如下：

- 查看命令帮助信息

  ```
  openGauss=# \h ABORT
  ```

- 切换数据库

  ```
  openGauss=# \c dbname
  ```

- 查询所有数据库

  ```
  openGauss=# \l
  ```

- 查询当前数据库中的所有表

  ```
  openGauss=# \dt
  ```

- 查看表结构

  ```
  \d tablename
  ```

- 列出所有数据库角色

  ```
  \du
  ```

  

个人对模式schema理解

所有的用户都是可以登陆到数据库管理系统的，只不过所有的资源都只对omm可见，而一般用户登陆的数据库管理系统时，数据库资源其实都是存在的，只不过因为omm账号对一般用户grant的权限有限，所以一般用户只能操作部分的资源。

gsql是一个操作数据库服务端的一个工具（客户端命令行）

开始的时候我们只有omm这一个系统管理员用户，依靠这个超级用户我们登陆到数据库管理系统（并不是某一个具体的数据库）对所有的资源进行操作，就好比综合楼的阿姨管理综合楼所有的教室一样，她们就是系统管理员，每一层楼就是一个表空间，每一间教室就是一个表，

而数据库这个概念更像是在这些表（教室）的大集合中挑选一部分（固定数量的教室）来构成一个子集。

在你创建了一个数据库之后，（当前用户）就可以对这些教室进行自定义的操作了。



比如一个团队在进行应用开发的时候，该团队只有一个omm账号，但是不同的人员分工不一样，A负责商品业务，B负责支付业务，C负责短信发送业务，这时，他们使用同一个数据库。首先，需要创建3个用户供A，B，C使用，然后通过创建不同的模式从而达到不同业务的隔离（

omm在数据库中创建一个good schema，并将模式所有者设置为A；

 omm在数据库中创建一个pay schema，并将模式所有者设置为B； 

omm在数据库中创建一个message模式，并将模式所有者设置为C；

然后他们就可以各自登陆数据库管理系统在自己的模式下创建自己的业务表了）

